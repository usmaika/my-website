<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player Film</title>
    <link rel="stylesheet" href="style.css">
    <script src="script.js" defer></script>
</head>
<body>
    <header>
        <h1 id="film-title">Menonton Film</h1>
        <a href="index.html" class="back-button">â¬… Kembali ke Beranda</a>
    </header>
    
    <main>
        <!-- Video Player -->
        <video id="player" controls autoplay>
            <source id="video-source" src="" type="video/mp4">
            Browser Anda tidak mendukung pemutar video.
        </video>
        <p id="error-message" style="color: red; display: none;">Video tidak ditemukan.</p>

        <!-- Pilihan Episode -->
        <section id="episode-list" style="display: none;">
            <h3>Pilih Episode:</h3>
            <div id="episodes" class="episode-container"></div>
        </section>
    </main>

    <script>
        // Ambil parameter dari URL
        const urlParams = new URLSearchParams(window.location.search);
        let seriesName = urlParams.get("series");
        let filmTitle = urlParams.get("title");
        let videoUrl = urlParams.get("video"); // Untuk film non-series
    
        // Atur judul halaman
        document.getElementById("film-title").textContent = filmTitle || "Menonton Film";
        document.title = filmTitle || "Menonton Film";
    
        const videoPlayer = document.getElementById("player");
        const videoSource = document.getElementById("video-source");

        // Jika ini adalah film biasa (bukan series)
        if (videoUrl) {
            videoSource.src = videoUrl;
            videoPlayer.load();
            videoPlayer.play().catch(() => {
                console.log("Autoplay diblokir oleh browser.");
            });
        }

        // Jika ini adalah series, tampilkan daftar episode
        if (seriesName) {
            const episodeList = document.getElementById("episode-list");
            const episodesDiv = document.getElementById("episodes");
            episodeList.style.display = "block";

            // Daftar episode
            const episodes = {
            konosuba: [
                { title: "Episode 1", url: `videos/konosubaeps1.mp4` },
                { title: "Episode 2", url: `videos/konosubaeps2.mp4` },
                { title: "Episode 3", url: `videos/konosubaeps3.mp4` },
                { title: "Episode 4", url: `videos/konosubaeps4.mp4` },
                { title: "Episode 5", url: `videos/konosubaeps5.mp4` },
                { title: "Episode 6", url: `videos/konosubaeps6.mp4` },
                { title: "Episode 7", url: `videos/konosubaeps7.mp4` },
                { title: "Episode 8", url: `videos/konosubaeps8.mp4` },
                { title: "Episode 9", url: `videos/konosubaeps9.mp4` },
                { title: "Episode 10", url: `videos/konosubaeps10.mp4` },
                { title: "Episode 11", url: `videos/konosubaeps11.mp4` }
            ],
            roshidere: [
                { title: "Episode 1", url: `videos/roshidereeps1.mp4` },
                { title: "Episode 2", url: `videos/roshidereeps2.mp4` },
                { title: "Episode 3", url: `videos/roshidereeps3.mp4` },
                { title: "Episode 4", url: `videos/roshidereeps4.mp4` },
                { title: "Episode 5", url: `videos/roshidereeps5.mp4` },
                { title: "Episode 6", url: `videos/roshidereeps6.mp4` },
                { title: "Episode 7", url: `videos/roshidereeps7.mp4` },
                { title: "Episode 8", url: `videos/roshidereeps8.mp4` },
                { title: "Episode 9", url: `videos/roshidereeps9.mp4` },
                { title: "Episode 10", url: `videos/roshidereeps10.mp4` },
                { title: "Episode 11", url: `videos/roshidereeps11.mp4` },
                { title: "Episode 12", url: `videos/roshidereeps12.mp4` }
            ],
            kekkonsuru: [
                { title: "Episode 1", url: `videos/kekkonsurueps1.mp4` },
                { title: "Episode 2", url: `videos/kekkonsurueps2.mp4` },
                { title: "Episode 3", url: `videos/kekkonsurueps3.mp4` },
                { title: "Episode 4", url: `videos/kekkonsurueps4.mp4` }
            ]
        };

            // Tampilkan daftar episode
            episodes.forEach((ep, index) => {
                const epLink = document.createElement("a");
                epLink.href = "#";
                epLink.textContent = ep.title;
                epLink.classList.add("episode-link");
                epLink.style.display = "block"; // Supaya episode muncul ke bawah

                // Saat episode diklik, ganti video tanpa reload halaman
                epLink.addEventListener("click", function (e) {
                    e.preventDefault();
                    videoSource.src = ep.url;
                    videoPlayer.load();
                    videoPlayer.play().catch(() => {
                        console.log("Autoplay diblokir oleh browser.");
                    });
                    document.getElementById("film-title").textContent = `${filmTitle} - ${ep.title}`;
                });

                episodesDiv.appendChild(epLink);

                // **Setel episode pertama secara default**
                if (index === 0) {
                    videoSource.src = ep.url;
                    videoPlayer.load();
                    videoPlayer.play().catch(() => {
                        console.log("Autoplay diblokir oleh browser.");
                    });
                }
            });
        }
    </script>
</body>
</html>
